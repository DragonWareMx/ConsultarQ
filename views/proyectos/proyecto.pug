extends ../main

block head
    title ConsultarQ - Proyecto
    link(rel="stylesheet" href="/stylesheets/others.css")
    link(rel="stylesheet" href="/stylesheets/oProgressBar.css")
    link(rel="stylesheet" href="/stylesheets/oProyectMenu.css")
    link(rel="stylesheet" href="/stylesheets/cajaChica.css")
    style(type="text/css").
        #scrollCom::-webkit-scrollbar {
        width: 4px;
        }
        #scrollCom::-webkit-scrollbar-thumb {
        background-color: #c1c1c1;
        border-radius: 4px;
        }
block content
    div(class="uk-container")
        div(class="uk-flex uk-flex-between uk-margin-top uk-flex-middle uk-flex-wrap")
                div(class="uk-text-left   uk-text-large   uk-text-bold uk-text-primary uk-margin-bottom") Proyecto 
                div(class="uk-animation-toggle uk-margin-bottom" tabindex="0")
                a(href="javascript:history.back(-1);" class="uk-text-right uk-flex-inline uk-flex uk-flex-middle uk-link-muted uk-link-heading uk-animation-shake" style="color:#6B6B72 !important")
                    img(src="/icons/netGray.png" style="width:20px;height:20px;margin-top:3px" class="uk-margin-small-right")
                    div Regresar
        div(class="uk-grid-collapse uk-child-width-1-1 uk-grid-row-large" uk-grid)
            div()
                div(class="uk-card uk-card-default")
                    -
                        var h = proyecto.color
                        var colorchido = h

                        let r = 0, g = 0, b = 0;

                        // 3 digits
                        if (h.length == 4) {
                            r = "0x" + h[1] + h[1];
                            g = "0x" + h[2] + h[2];
                            b = "0x" + h[3] + h[3];

                        // 6 digits
                        } else if (h.length == 7) {
                            r = "0x" + h[1] + h[2];
                            g = "0x" + h[3] + h[4];
                            b = "0x" + h[5] + h[6];
                        }

                        if(r > 200 && g > 200 && b > 200){
                            colorchido = '#000000'
                        }
                        
                        var color =  "rgba("+ +r + "," + +g + "," + +b + ",0.53)";
                    //- COLOR
                    div(class="uk-card-header uk-padding-remove uk-flex" style="background:"+color /* va cambiando el background*/)
                        //- NOMBRE
                        div(class="uk-width-3-5@m uk-margin-small-left uk-margin-small-top uk-margin-small-bottom")
                            div(class="" style="color: #222238;") #{proyecto.name}
                            if proyecto.Pro_Type
                                div(class="uk-text-small" style="min-height: 20.8px") #{proyecto.Pro_Type.name}
                            else
                                div(class="uk-text-small" style="min-height: 20.8px") 
                        //- ESTATUS
                        div(class="uk-width-2-5@m uk-flex uk-flex-right uk-flex-wrap-reverse")
                            div(class="uk-width-auto@l uk-flex uk-flex-right uk-flex-middle")
                                if proyecto.status == 'ATRASADO' || proyecto.status == 'CANCELADO'
                                    button(class="uk-margin-small-right" uk-tooltip="title: Estatus; pos: left" style="background:#F1A5A5;border-radius:2px;color:#DC5454;border:none;padding:7px;font-size:8px; outline:none") #{proyecto.status}
                                else if proyecto.status == 'EN TIEMPO' || proyecto.status == 'ACTIVO'
                                    button(class="uk-margin-small-right" uk-tooltip="title: Estatus; pos: left" style="background: #86DDAE;border-radius:2px;color: #129326;border:none;padding:7px;font-size:8px; outline:none" /* CAMBIA EL COLOR DEL TEXTO Y BACKGROUND*/) #{proyecto.status}
                            div(class="uk-width-auto@l uk-flex uk-flex-right")
                                a.uk-flex.uk-flex-middle.uk-text-small(href="/proyectos/editar/"+proyecto.id id="btnEdit" style="margin-right:10px")
                                    <span uk-icon="icon:pencil; ratio:0.8" style="margin-right:5px"></span>Editar
                    div(class="uk-width-1-1 uk-flex uk-flex-wrap")    
                        div(class="uk-width-1-3@l" style="border-right: 1px solid #EEEEEE; padding:5px")
                            //- FECHAS
                            div(class="uk-card-body uk-padding-remove")
                                div(class="uk-width-1 uk-margin-small-top")
                                    div(class="o-progress-date-line")
                                    //- EL COLOR DE LAS BOLITAS DEBE IR CAMBIANDO
                                    div(class="o-progress-date-start" style="background:"+colorchido)
                                    div(class="o-progress-date-end" style="background:"+colorchido)
                                    -
                                        const fechaII = new Date(proyecto.start_date+"T11:22:33+0000")
                                        const fechaI = fechaII.getTime()
                                        const fechaTI = new Date(proyecto.deadline+"T11:22:33+0000")
                                        const fechaT = fechaTI.getTime()
                                        var hoyI
                                        if(proyecto.end_date)
                                            hoyI = new Date(proyecto.end_date+"T11:22:33+0000")
                                        else
                                            hoyI = new Date()
                                        const hoy = hoyI.getTime()

                                        var diasF
                                        diasF = ((hoy-fechaI)/(fechaT-fechaI))*100

                                        if(diasF > 91)
                                            diasF = 91
                                        else if(diasF < 5)
                                            diasF = 5

                                        const MESES = [
                                        "ENE",
                                        "FEB",
                                        "MAR",
                                        "ABR",
                                        "MAY",
                                        "JUN",
                                        "JUL",
                                        "AGO",
                                        "SEP",
                                        "OCT",
                                        "NOV",
                                        "DIC",
                                        ];
                                        const f = new Date();

                                        mesI = MESES[fechaII.getMonth()];
                                        mesF = MESES[fechaTI.getMonth()];
                                    if proyecto.end_date
                                        div(class="o-progress-date-today" uk-tooltip=hoyI.getDate()+"/"+(hoyI.getMonth()+1)+"/"+hoyI.getFullYear() style="margin-left:"+diasF+"%; border: 1px solid"+colorchido /*Aquí en el margin va el valor del avance, calcularlo de alguna forma, pero no debe pasar de 93% ni ser menos de 5%*/)
                                    else
                                        div(class="o-progress-date-today" uk-tooltip="Hoy" style="margin-left:"+diasF+"%; border: 1px solid"+colorchido /*Aquí en el margin va el valor del avance, calcularlo de alguna forma, pero no debe pasar de 93% ni ser menos de 5%*/)
                                    div(class="o-progress-date-dates")
                                        div(class="uk-text-small") #{fechaII.getDate()}, #{mesI}, #{fechaII.getFullYear()}
                                        div(class="uk-text-small") #{fechaTI.getDate()}, #{mesF}, #{fechaTI.getFullYear()}
                            //- AVANCES TAREAS
                            -
                                var tareasListas = 0
                                var tareasFaltantes = 0
                                var tareasTotales = 0
                                var porcentaje = 100
                                var porcentajeRedondeado = 99
                            if proyecto.Tasks
                                each task in proyecto.Tasks
                                    -
                                        tareasTotales++
                                        if(task.check)
                                            tareasListas++
                                        else
                                            tareasFaltantes++
                                if tareasTotales > 0
                                    -
                                        porcentaje = parseInt((tareasListas/tareasTotales)*100)
                                        porcentajeRedondeado = Math.ceil(porcentaje/5)*5;
                                        if(porcentajeRedondeado >= 100)
                                            porcentajeRedondeado = 99
                            div(class="uk-width-1 uk-flex uk-flex-wrap uk-margin-small-top")
                                div(class="uk-width-2-5 uk-flex uk-flex-middle uk-flex-center")
                                    div(class="progress--circle progress--"+porcentajeRedondeado style="margin-top:0px" /*LOS VALORES DEBEN SER REDONDEADOS A MULTIPLOS DE 5, para el 100 porciento se ve mejor si se uusa unvalor diferente como por ejemplo 99*/)
                                        div(class="progress__number") #{porcentaje}%
                                div(class="uk-width-3-5 uk-width-1@s uk-width-3-5")
                                    div(class="uk-text-large" style="color: #222238;") #{tareasListas}
                                    div(class="uk-text-small") Tareas listas
                                    div(class="uk-text-large" style="color: #222238;") #{tareasFaltantes}
                                    div(class="uk-text-small") Tareas faltantes
                        div(class="uk-width-1-3@l uk-flex uk-flex-wrap" style="border-right: 1px solid #EEEEEE")
                            //-Cliente
                            div(class="uk-width-1-1 uk-padding-small div-datos-cliente-proyecto" style="border-bottom: 1px solid #EEEEEE;")
                                div.uk-width-1-1.uk-text-small.uk-margin-small-bottom DATOS DEL CLIENTE
                                if proyecto.Client
                                    div.uk-width-1-1.uk-flex.uk-flex-wrap
                                        div(class="uk-width-auto@s")
                                            if proyecto.Client.picture
                                                img(src="/uploads/clients/"+client.picture style="width:70px; height:70px; border-radius:50px; margin-right:15px;object-fit:cover")
                                            else
                                                img(src="/img/iconos/default.png" style="width:70px; height:70px; border-radius:50px; margin-right:15px;object-fit:cover")
                                        div(class="uk-width-expand@s uk-text-small")
                                            div.uk-flex.uk-width-1-1
                                                div(class="uk-width-auto@l" style="color:#222238; font-size:16px; font-weight:400") 
                                                    a.uk-link-reset.uk-text-truncate(href="/clientes/cliente/"+proyecto.Client.id) #{proyecto.Client.name}
                                            div.uk-width-1-1.uk-flex.uk-flex-middle(uk-tooltip="title: Teléfono; pos: left")
                                                <span uk-icon="icon:receiver; ratio: 0.8" style="margin-right:5px"></span> #{proyecto.Client.phone_number}
                                            div.uk-width-1-1.uk-flex.uk-flex-middle(style="word-break: break-all" uk-tooltip="title: Correo electrónico; pos: left")
                                                <span uk-icon="icon:mail; ratio: 0.8" style="margin-right:5px"></span> #{proyecto.Client.email}
                                            div.uk-width-1-1.uk-flex.uk-flex-middle(uk-tooltip="title: Área; pos: left")
                                                if proyecto.Client.Client_Area
                                                    <span uk-icon="icon:thumbnails; ratio: 0.8" style="margin-right:5px"></span> #{proyecto.Client.Client_Area.name}
                                                else
                                                    <span uk-icon="icon:thumbnails; ratio: 0.8" style="margin-right:5px"></span> SIN ÁREA
                                            div.uk-width-1-1.uk-flex.uk-flex-middle(uk-tooltip="title: Estatus; pos: left")
                                                if proyecto.Client.status == 'active'
                                                    div(class="uk-width-4-5@m btn-status-active") ACTIVO
                                                else
                                                    div(class="uk-width-4-5@m btn-status-active btn-status-noactive") INACTIVO
                                else
                                    div(class="uk-text-center uk-margin-medium-top") 
                                        div.uk-link-reset.uk-text-truncate 
                                            b SIN CLIENTE REGISTRADO
                            div(class="uk-width-1-1 uk-padding-small uk-text-small div-docs-proyecto") 
                                //-COTIZACIONES
                                div.uk-width-1-1.uk-flex.uk-flex-wrap.uk-flex-middle
                                    if proyecto.Quotations.length > 1
                                        div(class="uk-width-auto@s uk-text-truncate" style="margin-right:5px") Cotizaciones
                                    else
                                        div(class="uk-width-auto@s uk-text-truncate" style="margin-right:5px") Cotización
                                    div(class="uk-width-expand@s uk-text-emphasis" style="font-size:14px;")
                                        if proyecto.Quotations.length > 0
                                            each cotizacion in proyecto.Quotations
                                                a.uk-link-reset.uk-text-truncate(href="/uploads/docs/"+cotizacion.quotation target="_blank") #{cotizacion.quotation} <span uk-icon="icon:file-pdf; ratio: 0.6" style="margin-left:3px"></span>
                                        else
                                            a.uk-link-reset.uk-text-truncate() Sin cotizaciones
                                //-CONTRATO
                                div.uk-width-1-1.uk-flex.uk-flex-wrap.uk-margin-small-top.uk-flex-middle
                                    div(class="uk-width-auto@s" style="margin-right:5px") Contrato
                                    div(class="uk-width-expand@s uk-text-emphasis" style="font-size:14px")
                                        if proyecto.contract
                                            a.uk-link-reset.uk-text-truncate(href="/uploads/docs/"+proyecto.contract target="_blank") #{proyecto.contract} <span uk-icon="icon:file-pdf; ratio: 0.6" style="margin-left:3px"></span>
                                        else
                                            a.uk-link-reset.uk-text-truncate Sin contrato
                        
                        //-MIEMBROS
                        div(class="uk-width-1-3@l uk-padding-small" style="border-right: 1px solid #EEEEEE;")
                            div.uk-width-1-1.uk-text-small.uk-margin-small-bottom MIEMBROS DEL PROYECTO
                            if proyecto.Users.length > 0
                                each user in proyecto.Users
                                    div.uk-width-1-1.uk-text-small.uk-margin-small-bottom.uk-flex.uk-flex-middle
                                        div(class="uk-width-auto")
                                            if user.picture
                                                img(src="/uploads/avatar/"+user.picture uk-tooltip=user.Employee.name width="33px" style="width:30px; height:30px; border-radius:50px; margin-right:15px;object-fit:cover")
                                            else
                                                img(src="/img/iconos/default.png" width="33px" uk-tooltip=user.Employee.name style="width:30px; height:30px; border-radius:50px; margin-right:15px;object-fit:cover")
                                        div(class="uk-width-expand uk-text-small")
                                            div.uk-flex.uk-width-1-1
                                                div(class="uk-width-auto@m" style="color:#222238; font-size:14px; font-weight:400") 
                                                    a.uk-link-reset.uk-text-truncate() #{user.Employee.name}
                                            div.uk-flex.uk-width-1-1
                                                each empleado in proyecto.Project_Employees
                                                    if empleado.UserId == user.id
                                                        if empleado.role && empleado.profit
                                                            div(class="uk-width-auto@m" style="font-size:14px; font-weight:400") #{empleado.role} - #{empleado.profit}%
                                                        else if empleado.role
                                                            div(class="uk-width-auto@m" style="font-size:14px; font-weight:400") #{empleado.role} - Sin porcentaje
                                                        else if empleado.profit
                                                            div(class="uk-width-auto@m" style="font-size:14px; font-weight:400") Sin rol - #{empleado.profit}%
                                                        else
                                                            div(class="uk-width-auto@m" style="font-size:14px; font-weight:400") Sin rol - Sin porcentaje
                            else
                                a.uk-link-reset.uk-text-truncate SIN MIEMBROS
                            div.uk-width-1-1.uk-text-small.uk-flex.uk-flex-right 
                                    a.uk-flex.uk-flex-middle.uk-text-small.uk-link-heading(id="ver-comentarios" uk-tooltip="title: Comentarios; pos: left")
                                        div(id="comSpan")
                                            <span uk-icon="icon: commenting; ratio: 0.7" style="margin-right:5px"></span> #{comentarios.length}
        //- COMENTARIOS-----------------------
        div(class="uk-card uk-width-1-1 uk-card-default uk-margin-top uk-padding-small"  id="Comentarios")
            div.width-1-1.uk-text-small.uk-flex.uk-flex-wrap-reverse.uk-flex-middle
                div.uk-width-auto 
                    b COMENTARIOS
                div.uk-width-auto.uk-margin-left.uk-flex.uk-flex-middle
                    <span uk-icon="icon: commenting; ratio: 0.7" style="margin-right:5px"></span> #{contadorComentarios}
                div.uk-width-expand
                    a.uk-flex.uk-flex-middle(id="nover-comentarios" style="width:max-content; float:right")
                        <img src="/icons/notEye.png" style="width:15px;height:15px; margin-right:5px">
                        |Ocultar
            //- AGREGAR COMENTARIO
            form(id="form-create-comment" action="/proyectos/proyecto/"+proyecto.id+"/comment" method="POST")
                div.uk-text-primary.uk-margin-small-bottom(style="font-size:13px") Agregar comentario
                div(id="errors")
                textarea(class="uk-textarea field uk-margin-bottom uk-text-emphasis textarea-caja" style="font-size:14px; border-radius:3px; height:auto !important;" placeholder="Máximo 150 caracteres" autocomplete='on' id="descripcion" name="descripcion" value='' onchange="this.setAttribute('value', this.value);" required='' maxlength="150")
                div(class="uk-width-1 uk-flex-right uk-flex uk-margin-small-bottom")
                    //- button(class="uk-button uk-button-text uk-margin-medium-right uk-text-primary uk-text-capitalize uk-modal-close" id="btn-close-modal" type="button" ) Cancelar
                    button(class="uk-button uk-button-primary uk-border-rounded uk-text-capitalize" id="btnEnviar" type="submit") Comentar
            div#comentDiv(data-simplebar)
                -function prettyDate(dateString){
                    //if it's already a date object and not a string you don't need this line:
                    -var date = new Date(dateString);
                    -var d = date.getDate();
                    -var monthNames = [ "Enero", "Febrero", "Marzo", "Abril", "Mayo", "Junio","Julio", "Agosto", "Septiembre", "Octubre", "Noviembre", "Diciembre" ];
                    -var m = monthNames[date.getMonth()];
                    -var y = date.getFullYear();
                    -return d+' de '+m+' del '+y;
                -}
                div(style="max-height: 491.6px; overflow-y:scroll" id="scrollCom")
                    each comentario in comentarios                
                        div.uk-width-1-1.uk-margin-small.uk-padding-small.uk-flex.uk.flex.wrap(style="border: solid 1px #EEEEEE; boder-radius:2px")
                            div(class="uk-width-auto")
                                img(src="/img/iconos/default.png" style="width:40px; height:40px; border-radius:50px; margin-right:15px;object-fit:cover")
                            div(class="uk-width-expand uk-text-small uk-flex uk-flex-column")
                                div.uk-width-1-1.uk-flex.uk-flex-wrap.uk-flex-middle.uk-flex-between
                                    div(class="uk-width-auto@s" style="color:#222238; margin-right:5px") #{comentario.User.Employee.name}
                                    div(class="uk-width-auto@s" style="font-size:12px;") #{prettyDate(comentario.createdAt)}
                                div.uk-width-1-1 #{comentario.comment}
            
        //- OBSERVACIONES-------------
        if proyecto.observations
            div(class="uk-card uk-width-1-1 uk-card-default uk-margin-top uk-padding-small") 
                div.width-1-1.uk-text-small.uk-flex.uk-flex-wrap-reverse.uk-flex-middle 
                    b OBSERVACIONES
                div.uk-text-small.uk-text-emphasis #{proyecto.observations}
        else
            div(class="uk-card uk-width-1-1 uk-card-default uk-margin-top uk-padding-small") 
                div.width-1-1.uk-text-small.uk-flex.uk-flex-wrap-reverse.uk-flex-middle 
                    b SIN OBSERVACIONES
                div.uk-text-small.uk-text-emphasis 
        //- TAREAS DEL PROYECTO------------------------
        
        div(class="uk-card uk-card-default uk-width-1-1 uk-margin-top uk-card-body uk-padding-small")
            div(class="uk-flex uk-flex-top uk-flex-between")
                div(class="uk-text-primary uk-margin-bottom ")
                    if proyecto.Tasks.length > 0 
                        b TAREAS
                    else
                        b SIN TAREAS
                //- div(class="uk-flex uk-flex-middle")
                    a.uk-margin-small-right(href="#" uk-toggle="target: #editDocument-form")
                        <span uk-icon="pencil"></span>
                    a.uk-margin-small-left(href="#" uk-toggle="target: #deleteDocument-form" style="color:#DC5454")
                        <span uk-icon="trash"></span>
            div(class="uk-overflow-auto")
                if proyecto.Tasks.length > 0 
                    table(class="uk-table uk-table-small uk-table-divider uk-table-justify uk-text-small")
                        thead
                            tr
                                th(class="uk-text-center uk-table-shrink") #
                                th(class="uk-text-truncate uk-table-expand") Concepto
                                th(class="uk-text-truncate uk-table-expand") Descripción
                                th(class="uk-text-truncate uk-width-small") Cantidad
                                th(class="uk-text-truncate uk-width-small") Unidad
                                th(class="uk-text-truncate  uk-width-small") Costo/U
                                th(class="uk-text-truncate uk-width-small") Costo/T
                                th(class="uk-text-truncate uk-width-small") Realizado
                        tbody
                            each task, index in proyecto.Tasks
                                tr(uk-toggle="target: #editTask-form" class="editar" data-id=1) 
                                    td #{index+1}
                                    td #{task.concept}
                                    td #{task.description}
                                    td #{task.units}
                                    td #{task.unit}
                                    td #{task.price}
                                    if task.price*task.units > 0
                                        td #{task.price*task.units}
                                    else
                                        td
                                    if task.check
                                        td Sí 
                                    else
                                        td No
            div(class="uk-flex uk-flex-left uk-text-small uk-flex-middle uk-width-1 uk-margin-top uk-margin-small-bottom")
                a(href="/proyectos/documentacion/editar/"+proyecto.id)
                    <span uk-icon="icon: settings; ratio: 0.8" style="margin-right:5px"></span>Administrar tareas
        //- FINANZAS DEL PROYECTO--------------------------
        div(class="uk-flex uk-flex-wrap-reverse uk-width-1-1")
            div(class="uk-card uk-card-default uk-width-1-1 uk-margin-top")
                div(class="uk-card-body uk-text-center uk-padding-remove")
                    div(class="uk-text-primary uk-width-1-1 uk-padding-small uk-text-left uk-margin-remove") 
                        if movimientos.length > 0
                            b MOVIMIENTOS DEL PROYECTO
                        else
                            b SIN MOVIMIENTOS
                    div(class="uk-overflow-auto uk-margin-remove")
                        if movimientos.length > 0
                            table(class="uk-table uk-table-divider uk-text-small")
                                thead
                                    tr
                                        th(class="uk-text-center") #
                                        th(class="uk-text-center") MIEMBRO
                                        th(class="uk-text-center") CONCEPTO
                                        th(class="uk-text-center") DESCRIPCIÓN
                                        th(class="uk-text-center") MONTO
                                        th(class="uk-text-center") TIPO DE PAGO
                                        th(class="uk-text-center") MOVIMIENTO
                                        th(class="uk-text-center") DEDUCIBLE
                                        th(class="uk-text-center") FECHA
                                tbody
                                    each transaccion in movimientos
                                        tr(class="info")
                                            td #{transaccion.id}
                                            td #{transaccion.Project_Employee.User.Employee.name}
                                            td #{transaccion.Concept.name}
                                            td #{transaccion.description}
                                            td $#{transaccion.amount}
                                            td #{transaccion.Pa_Type.name}
                                            if(transaccion.T_type == 'egreso')
                                                td Egreso
                                            else
                                                td Ingreso
                                            if transaccion.invoce
                                                td Sí
                                            else
                                                td No
                                            td #{transaccion.date}

        
        //- PROVEEDORES DEL PROYECTO---------------------------
        div(class="uk-flex uk-flex-wrap-reverse uk-width-1-1")
            div(class="uk-card uk-card-default uk-width-1-1 uk-margin-top")
                div(class="uk-card-body uk-text-center uk-padding-remove")
                    div(class="uk-text-primary uk-width-1-1 uk-padding-small uk-text-left uk-margin-remove")
                        if proyecto.Providers.length > 0
                            b PRESTADORES EXTERNOS
                        else
                            b SIN PRESTADORES EXTERNOS
                    div(class="uk-overflow-auto uk-margin-remove")
                        if proyecto.Providers.length > 0
                            table(class="uk-table uk-table-divider uk-text-small")
                                thead
                                    tr
                                        th(class="uk-text-center") #
                                        th(class="uk-text-center") NOMBRE
                                        th(class="uk-text-center") ÁREA
                                        th(class="uk-text-center") TELÉFONO
                                        th(class="uk-text-center") CORREO ELECTRÓNICO
                                        th(class="uk-text-center") NÚMERO DE DRO
                                        th(class="uk-text-center") ESTATUS
                                tbody
                                    each proveedor in proyecto.Providers
                                        tr(class="info")
                                            td #{proveedor.id}
                                            td #{proveedor.name}
                                            if proveedor.Provider_Area
                                                td #{proveedor.Provider_Area.name}
                                            else
                                                td SIN ÁREA
                                            td #{proveedor.phone_number}
                                            td #{proveedor.email}
                                            td #{proveedor.dro}
                                            if proveedor.status == 'active'
                                                td(class="status") Activo
                                            else
                                                td(class="status") Inactivo
    
    
    
    
    
    //- Modal para editar tarea
    div(id="editTask-form" uk-modal)
        div(class="uk-modal-dialog uk-modal-body")
            div(class="uk-flex uk-flex-between")
                div(class="uk-text-left  uk-text-large uk-text-bold uk-text-primary") Editar tarea
                div(class="uk-flex uk-flex-middle uk-text-small")
                    a.uk-flex.uk-flex-middle(href="#" uk-toggle="target: #deleteTask-form" style="color:#DC5454")
                        <span uk-icon="icon:trash; ratio:0.8" style="margin-right:5px"></span>Eliminar
                    //- img(src="/icons/delete.png" width="12px")
                    //- a(class="uk-text-danger uk-text-small uk-margin-small-left") Eliminar
            button(type='button' uk-close='' class="uk-modal-close-default")
            div(id="errors-editTask")
            form(class="uk-card-body uk-padding-remove uk-margin-top" id="form-edit-task" action="" method="POST" enctype="multipart/form-data")
                div(class="uk-child-width-1 uk-grid")
                    div
                        .field.uk-margin-bottom
                            input(type='text' autocomplete='off' id="concepto-edit" name="concepto" value='' onchange="this.setAttribute('value', this.value);" required='')
                            label(for='concepto-edit' title='Concepto' data-title='Concepto')
                        .field.uk-margin-bottom
                            input(type='text' autocomplete='off' id="descripcion-edit" name="descripcion" value='' onchange="this.setAttribute('value', this.value);" required='')
                            label(for='descripcion-edit' title='Descripcion' data-title='Descripcion')
                    div
                        div.uk-grid
                            div(class="uk-width-1-2@s uk-width-1-1")
                                .field.uk-margin-bottom
                                    input(type='number' autocomplete='off'  id="cantidad-edit" name="cantidad"  value='' onchange="this.setAttribute('value', this.value);" required='')
                                    label(for='cantidad-edit' title='Cantidad' data-title='Cantidad')
                            div(class="uk-width-1-2@s uk-width-1-1")
                                .field.uk-margin-bottom
                                    input(type='text' autocomplete='off'  id="unidad-edit" name="unidad"  value='' onchange="this.setAttribute('value', this.value);" required='')
                                    label(for='unidad-edit' title='Unidad' data-title='Unidad')
                            div(class="uk-width-1-2@s uk-width-1-1")
                                .field.uk-margin-bottom
                                    input(type='number' autocomplete='off'  id="costo-edit" name="costo"  value='' onchange="this.setAttribute('value', this.value);")
                                    label(for='costo-edit' title='Costo' data-title='Costo')
                            div(class="uk-width-1-2@s uk-width-1-1 uk-flex uk-flex-top uk-flex-left")
                                input(type='checkbox' autocomplete='off'  id="realizado-edit" name="realizado" onchange="this.setAttribute('value', this.value);" style="margin-top:5px")
                                label(for='realizado-edit' class="uk-text-primary") Realizado
                    div(class="uk-flex uk-flex-right@s uk-flex-center uk-margin-top")
                        button(class="uk-button uk-button-text uk-margin-medium-right uk-text-primary uk-text-capitalize uk-modal-close" type="button" ) Cancelar
                        button(class="uk-button uk-button-primary uk-border-rounded uk-text-capitalize" id="editTask" type="submit") Guardar
    //- Modal para eliminar tarea 
    div(id="deleteTask-form" uk-modal)
        div(class="uk-modal-dialog uk-modal-body")
            div(class="uk-text-left  uk-text-large uk-text-bold uk-text-danger") Eliminar tarea
            button(type='button' uk-close='' class="uk-modal-close-default")
            div(id="errors-deleteTask")
            div(class="uk-text-left" id="textTask-delete") ¿Estás seguro de que deseas eliminar la tarea?
            form(class="uk-card-body uk-padding-small" id="form-delete-task" action=""  method="POST")
                div(class="uk-width-1 uk-flex-right uk-flex uk-flex-middle")
                    button(class="uk-button uk-button-text uk-margin-medium-right uk-text-primary uk-text-capitalize uk-modal-close" type="button" ) Cancelar
                    button(class="uk-button uk-button-danger uk-border-rounded uk-text-capitalize" id="deleteTask" type="submit") Eliminar         
    //- Modal para agregar tarea
    div(id="task-form" uk-modal)
        div(class="uk-modal-dialog uk-modal-body")
            div(class="uk-text-left  uk-text-large uk-text-bold uk-text-primary") Agregar tarea
            button(type='button' uk-close='' class="uk-modal-close-default")
            div(id="errors-task")
            form(class="uk-card-body uk-padding-remove uk-margin-top" id="form-new-task" action="/proyectos/documentacion/"+1+"/tarea/agregar" method="POST" enctype="multipart/form-data")
                div(class="uk-child-width-1 uk-grid")
                    div
                        .field.uk-margin-bottom
                            input(type='text' autocomplete='off' id="concepto" name="concepto" value='' onchange="this.setAttribute('value', this.value);" required='')
                            label(for='concepto' title='Concepto' data-title='Concepto')
                        .field.uk-margin-bottom
                            input(type='text' autocomplete='off' id="descripcion" name="descripcion" value='' onchange="this.setAttribute('value', this.value);" required='')
                            label(for='descripcion' title='Descripcion' data-title='Descripcion')
                    div
                        div.uk-grid
                            div(class="uk-width-1-2@s uk-width-1-1")
                                .field.uk-margin-bottom
                                    input(type='number' autocomplete='off'  id="cantidad" name="cantidad"  value='' onchange="this.setAttribute('value', this.value);" required='')
                                    label(for='cantidad' title='Cantidad' data-title='Cantidad')
                            div(class="uk-width-1-2@s uk-width-1-1")
                                .field.uk-margin-bottom
                                    input(type='text' autocomplete='off'  id="unidad" name="unidad"  value='' onchange="this.setAttribute('value', this.value);" required='')
                                    label(for='unidad' title='Unidad' data-title='Unidad')
                            div(class="uk-width-1-2@s uk-width-1-1")
                                .field.uk-margin-bottom
                                    input(type='number' autocomplete='off'  id="costo" name="costo"  value='' onchange="this.setAttribute('value', this.value);")
                                    label(for='costo' title='Costo' data-title='Costo')
                            div(class="uk-width-1-2@s uk-width-1-1 uk-flex uk-flex-top uk-flex-left")
                                input(type='checkbox' autocomplete='off'  id="realizado" name="realizado" onchange="this.setAttribute('value', this.value);" style="margin-top:5px")
                                label(for='realizado' class="uk-text-primary") Realizado
                    div(class="uk-flex uk-flex-right@s uk-flex-center uk-margin-top")
                        button(class="uk-button uk-button-text uk-margin-medium-right uk-text-primary uk-text-capitalize uk-modal-close" type="button" ) Cancelar
                        button(class="uk-button uk-button-primary uk-border-rounded uk-text-capitalize" id="task" type="submit") Agregar
    
    
    
    
    
    div(id="scripts")
        script.
            jQuery(($) => {
                $('#ver-comentarios').on('click', function() {
                    if ($("#Comentarios").is(':visible')) {
                        $("#Comentarios").slideUp('fast');
                    }
                    else{
                        $("#Comentarios").slideDown('fast');                    
                    }
                });
                $('#nover-comentarios').on('click', function() {
                    if ($("#Comentarios").is(':visible')) {
                        $("#Comentarios").slideUp('fast');
                    }
                    else{
                        $("#Comentarios").slideDown('fast');                    
                    }
                });
            });

            $(document).ready(function () {
                //ajax del form de nuevo

                $("#form-create-comment").bind("submit",function(){
                    // Capturamnos el boton de envío
                    var btnEnviar = $("#btnEnviar");

                    $.ajax({
                        type: $(this).attr("method"),
                        url: $(this).attr("action"),
                        data: $(this).serialize(),
                        beforeSend: function(data){
                            /*
                            * Esta función se ejecuta durante el envió de la petición al
                            * servidor.
                            * */
                            // btnEnviar.text("Enviando"); Para button
                            btnEnviar.val("Enviando"); // Para input de tipo button
                            btnEnviar.attr("disabled","disabled");
                        },
                        complete:function(data){
                            /*
                            * Se ejecuta al termino de la petición
                            * */
                            btnEnviar.val("Enviar formulario");
                        },
                        success: function(data){
                            /*
                            * Se ejecuta cuando termina la petición y esta ha sido
                            * correcta
                            * */
                            $('#errors').css('display', 'none');
                            UIkit.notification({
                                message: '<span uk-icon=\'icon: check\'></span>Comentario enviado con éxito!',
                                status: 'success',
                                pos: 'top-center',
                                timeout: 1000
                            });
                            $( "#comentDiv" ).load(location.href + " #comentDiv");
                            $( "#comSpan" ).load(location.href + " #comSpan");
                            $( "#scripts" ).load(location.href + " #scripts");
                            btnEnviar.removeAttr("disabled");
                            $("#descripcion").val("");
                        },
                        error: function(data){
                            /*
                            * Se ejecuta si la peticón ha sido erronea
                            * */
                            btnEnviar.removeAttr("disabled");
                            $('#errors').css('display', 'block');
                            var errors = JSON.parse(data.responseText);
                            var errorsContainer = $('#errors');
                            errorsContainer.innerHTML = '';
                            var errorsList = '';
                            for (var i = 0; i < errors.length; i++) {
                                //if(errors[i].redirect)
                                    //window.location.href = window.location.origin + '/logout'
                                errorsList += '<div class="uk-alert-danger" uk-alert><a class="uk-alert-close" uk-close></a><p>'+ errors[i].msg +'</p></div>';
                            }
                            errorsContainer.html(errorsList);

                            UIkit.notification({
                                message: '<span uk-icon=\'icon: close\'></span>No se pudo enviar el comentario!',
                                status: 'danger',
                                pos: 'top-center',
                                timeout: 2000
                            });
                        }
                    });
                    // Nos permite cancelar el envio del formulario
                    return false;
                });
            });